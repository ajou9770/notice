<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-KK94CHFLLe+nY2dmCWGMq91rCGa5gtU4mk92HdvYe+M/SXH301p5ILy+dN9+nJOZ" crossorigin="anonymous">
    <script>
      function handleFormSubmit(e) {
        alert("submited!!");
        var discordWebhookUrl = "https://discordapp.com/api/webhooks/1104042651805831298/XDXauKzP_w6XwlrVwNgHF3UpqaB5fvlLh5NwYMrLts14ZlZiE3BaYpN9sF41bUXeYuqf"; // Discord Webhook URL 입력
        var timestamp = new Date();
        var response = e.response;
        var itemResponses = response.getItemResponses();
      
        var formResponse = "";
        for (var i = 0; i < itemResponses.length; i++) {
          var item = itemResponses[i].getItem();
          var question = item.getTitle();
          var answer = itemResponses[i].getResponse();
          formResponse += question + ": " + answer + "\n";
        }
        var payload = {
          "content": "💬새로운 휴가 신청서가 제출되었습니다",
          "embeds": [{
            "title": "Google Form Response",
            "description": formResponse,
            "timestamp": timestamp.toISOString(),
            "color": 0x00ff00
          }]
        };
        var options = {
          "method": "POST",
          "contentType": "application/json",
          "payload": JSON.stringify(payload)
        };      
        UrlFetchApp.fetch(discordWebhookUrl, options);
      }
    </script>
<style>
        body {
            padding: 10px;
            margin: 5px;
        }
        h4, h3 {
            font-family: Arial, Helvetica, sans-serif;
            font-weight: 500;
        }
        .text-center {
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="text-center"><h3>[직원휴가사용내역_2023]</h3></div>
        <form class="row g-3" id="myForm" onsubmit="handleFormSubmit(this)">
        <div class="row g-3">
         <h5>🤷‍♂️직원 선택</h5>
         <select class="form-select" name="name" required>
         <option value="" selected>선택하세요</option>
         <option value="김설호 상무">김설호 상무</option>
         <option value="이연주 부장">이연주 부장</option>
         <option value="한진희 차장">한진희 차장</option>
         <option value="이정민 과장">이정민 과장</option>
         <option value="김기헌 과장">김기헌 과장</option>
        </select> 
      <h5>✨휴가종류</h5>
      <div class="col">
        <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="vactype" value="반반휴" >
        <label class="form-check-label" for="반반휴">반반휴</label>
        </div>
        <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="vactype" value="반휴" >
        <label class="form-check-label" for="반휴">반휴</label>
        </div>
        <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="vactype" value="연차" >
        <label class="form-check-label" for="연차">연차</label>
        </div>
        <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="vactype" value="경조휴가" >
        <label class="form-check-label" for="경조휴가">경조휴가</label>
        </div>
        <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="vactype" value="공가(교육)" >
        <label class="form-check-label" for="공가(교육)">공가(교육)</label>
        </div>
        <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" name="vactype" value="기타휴가" >
        <label class="form-check-label" for="기타휴가">기타휴가</label>
        </div>
       </div>
      </div>
        <div class="col">
        <label for="start-date" class="form-label">📅휴가시작일</label>
        <input type="date" class="form-control" id="start-date" name="startdate" required>
        </div>
        <div class="col">
        <label for="end-date" class="form-label">📅휴가종료일</label>
        <input type="date" class="form-control" id="end-date" name="enddate" required>
        </div>
        <hr>
        <div class="col">
        <label for="name" class="form-label">🔢휴가일수(#반반휴 0.25 #반휴 0.5 )</label>
        <input type="number" step="0.25" class="form-control" id="long-day" name="longday" required>
      </div>
         <br>
         <div class="row g-3">
         <div class="col">
        <h6>📝기타 참고사항(선택)</h6>
        <input type="text" class="form-control" id="etc" name="etc">
         </div>
      </div>
         <hr>
         <button type="submit" class="btn btn-primary btn-block">Submit</button>
    </form>
</html>
